<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Signup — Muniverse</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" href="/static/img/favicon.png" type="image/png">
  <link href="static/css/style.css" rel="stylesheet" />
</head>
<body>
  <header class="topbar">
    <a class="logo" href="onboarding.html">
      <img class="logo-image" src="static/img/favicon.png" alt="Muniverse Logo">
      <span>Muniverse</span>
    </a>  
  </header>

  <main class="container narrow">
    <h2 class="section-title">Create your profile</h2>

    <form class="card form" id="signupForm" action="signup.html" method="POST" enctype="multipart/form-data" novalidate>
      <div class="two-col">
        <label>Full Name
          <input required name="name" placeholder="e.g., Jayson MUNs" />
        </label>
        <label>Username
          <input required name="username" placeholder="e.g., aank" pattern="^[A-Za-z0-9_.\\-]{3,24}$" />
          <small>3–24 chars, letters/numbers/._-</small>
        </label>
      </div>

      <label>School / Institution
        <input required name="school" placeholder="e.g., Horizon International School" />
      </label>

      <label>Short Bio
        <textarea required name="bio" rows="3" placeholder="Delegate, council interests, awards..."></textarea>
      </label>

      <div class="two-col">
        <label>Password
          <input name="password" type="password" required minlength="6" placeholder="min 6 characters">
        </label>
        <label>Confirm Password
          <input name="password_confirm" type="password" required minlength="6" placeholder="retype password">
        </label>
      </div>

      <label>Profile photo (required)
        <input type="file" name="profile_photo" accept="image/*" required />
        <small>Please ensure all details are correct <code>it will refresh</code> if there are any mistakes</small>
      </label>
      
      <label for="privacy-policy-agree">
        <input type="checkbox" id="privacy-policy-agree" name="privacy_policy_agree" value="agreed" required>
        I agree with the <a href="privacypolicy.html" target="_blank">Privacy Policy</a>.
      </label>

      <button class="btn btn-primary" type="submit">Join Muniverse</button>
    </form>
  </main>

  <script>
    document.getElementById("signupForm").addEventListener("submit", function(e) {
      const form = e.target;
      const name = form.name.value.trim();
      const username = form.username.value.trim();
      const school = form.school.value.trim();
      const bio = form.bio.value.trim();
      const password = form.password.value;
      const confirm = form.password_confirm.value;
      const photo = form.profile_photo.files.length;
      const privacyCheck = form.privacy_policy_agree.checked;

      const usernamePattern = /^[A-Za-z0-9_.\-]{3,24}$/;

      if (!name || !username || !school || !bio || !password || !confirm || !photo) {
        alert("Please fill in all required fields.");
        e.preventDefault();
        return;
      }

      if (!usernamePattern.test(username)) {
        alert("Invalid username. Use 3–24 letters, numbers, dots, underscores, or hyphens.");
        e.preventDefault();
        return;
      }

      if (password.length < 6) {
        alert("Password must be at least 6 characters long.");
        e.preventDefault();
        return;
      }

      if (password !== confirm) {
        alert("Passwords do not match.");
        e.preventDefault();
        return;
      }
      
      if (!privacyCheck) {
        alert("You must agree to the Privacy Policy to join.");
        e.preventDefault();
        return;
      }
    });
  </script>
</body>
</html>
